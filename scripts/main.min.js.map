{"version":3,"sources":["node_modules/browser-pack/_prelude.js","app/scripts/calculator.coffee","app/scripts/fractions-parser.coffee","app/scripts/fractions-peg-parser.js","app/scripts/fractions.coffee","app/scripts/index.coffee"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Parser","options","output","onError","$input","curr","isRes","val","v","this","hasResult","canInput","key","exp","parsed","ref","parse","ast","error","incomplete","numbers","input","calc","match","process","uninput","value","clear","slice","info","trim","render","rendered","result","decimal","toFloat","toString","Parsed","fraction","interpret","parser","tryParseAsIncompleteExpression","ast1","error1","closeParens","openParens","parensAdded","replaceNumberWithMissing","recur","arg","type","last","newExp","symbolsAdded","numbersAdded","parens","symbols","message","interpreter","map","post","num","create","add","reduce","minus","mul","div","reciprocal","mixed","ref1","w","over","withResult","s","ret","m","toMixedString","missing","d","replace","peg$SyntaxError","expected","found","location","name","captureStackTrace","ctor","constructor","child","parent","prototype","SyntaxError","arguments","peg$FAILED","peg$startRuleFunctions","S","peg$parseS","peg$startRuleFunction","peg$c0","description","peg$c1","peg$c2","peg$c3","peg$c4","peg$c5","left","right","concat","peg$c6","peg$c7","peg$c8","peg$c9","peg$c10","peg$c11","peg$c12","peg$c13","peg$c14","peg$c15","peg$c16","peg$c17","peg$c18","whole","peg$c19","peg$c20","peg$c21","peg$c22","peg$c23","peg$c24","sign","expression","peg$c25","peg$c26","uint","parseInt","peg$c27","peg$c28","peg$c29","peg$c30","digits","join","peg$currPos","peg$posDetailsCache","line","column","seenCR","peg$maxFailPos","peg$maxFailExpected","peg$silentFails","startRule","peg$computePosDetails","pos","ch","details","charAt","peg$computeLocation","startPos","endPos","startPosDetails","endPosDetails","start","offset","end","peg$fail","push","peg$buildException","cleanupExpected","sort","b","splice","expectedDescs","Array","hex","charCodeAt","toUpperCase","peg$parseE","s0","s1","s2","s3","s4","s5","peg$parseT","peg$parseF","peg$parseI","peg$parseU","test","peg$result","div0","gcd","Fraction","Math","abs","isProper","floor","l","$","jQuery","toggleButtons","$calculator","$output","$decimal","$buffer","$parsed","adjustCss","css","adjustParens","filter","text","addClass","getPlaceholders","adjustPlaceholders","adjustFraction","children","tex","MathJax","Hub","Queue","Typeset","get","html","scrollLeft","calculator","alert","getKey","$b","data","$buttons","charCodes","keypress","which","String","fromCharCode","keyCode","index","keydown","preventDefault","click","each","removeAttribute","setAttribute","focus"],"mappings":"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","file":"main.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","### global module,require ###\n\nParser = require './fractions-parser'\n\n# Incomplete :: { parens::Num, numbers::Num, symbols::Num }\n# OutputInfo :: { decimal::Num?, incomplete::Incomplete? }\n\n# (options::{\n#   output: (tex::Str, info::OutputInfo?) -> None\n#   onError: (message::Str) -> None\n# }) ->\n# {\n#   canInput: (key::Str) -> Bool\n#   input: (key::Str) -> None\n#   uninput: (None) -> None\n# }\ncalculator = (options) ->\n\n  {output, onError} = options\n\n  $input =\n    curr: ''\n    isRes: false\n    val: (v, r = false) ->\n      if v?\n        @curr = v\n        @isRes = r\n      @curr\n    hasResult: ->\n      @isRes\n\n  # canInput :: (key::Str) -> Bool\n  canInput = (key) ->\n    return true if key is 'C' # \"clear\"\n    if key is '='\n      exp = $input.val()\n      parsed = Parser.parse exp\n      !parsed.ast.error and !parsed.ast.incomplete?.numbers\n    else\n      exp = $input.val() + key\n      return true if !exp\n      parsed = Parser.parse exp\n      !parsed.ast.error\n\n  # input :: (key::Str) -> None\n  input = (key) ->\n    $input.val(key = '') if key is 'C' # \"clear\"\n    if key is '='\n      calc()\n    else\n      if $input.hasResult() and key.match /\\d/\n        $input.val key\n      else\n        $input.val $input.val() + key\n      process()\n\n  # uninput :: (None) -> None\n  uninput = ->\n    return clear() if $input.hasResult()\n    value = $input.val()\n    $input.val value[0...-1] # trim last element\n    process()\n\n  clear = -> output ''\n\n  process = ->\n    exp = $input.val()\n    return clear() if !exp.trim()\n    parsed = Parser.parse exp\n    if parsed.ast.error?\n      uninput()\n    else\n      info = incomplete: parsed.ast.incomplete if parsed.ast.incomplete?\n      output parsed.render(), info\n\n  calc = ->\n    exp = $input.val()\n    return clear() if !exp.trim()\n    parsed = Parser.parse exp\n    return if parsed.ast.incomplete?.numbers > 0\n    rendered = parsed.render result: yes\n    if !rendered.error\n      result = parsed.calc()\n      output rendered, { decimal: result.toFloat() }\n      # move the result to the input\n      $input.val result.toString(), true\n    else\n      onError rendered.error\n\n  clear()\n\n  {canInput, input, uninput}\n\nmodule.exports = calculator\n","### global module,require ###\n\nfraction = require './fractions'\nparser = require './fractions-peg-parser'\n\nparse = (exp) ->\n  try\n    parser.parse exp\n  catch error\n    tryParseAsIncompleteExpression exp, error\n\ntryParseAsIncompleteExpression = (exp, error) ->\n\n  replaceNumberWithMissing = (ast) ->\n    recur = (o) ->\n      if o.arg\n        if o.arg.length\n          if o.arg[o.arg.length - 1].type is 'missing'\n            return recur o.arg[o.arg.length - 2]\n          else\n            return recur o.arg[o.arg.length - 1]\n        else if o.type isnt 'num'\n          return recur o.arg\n      o\n    last = recur ast\n    if last.arg is -1\n      last.type = 'minus'\n      last.arg = type: 'missing'\n    else\n      last.type = 'missing'\n      delete last.arg\n\n  # try to create a valid expression\n  newExp = exp\n\n  symbolsAdded = 0\n  numbersAdded = 0\n\n  # if it ends with a non-number (except a closing parenthesis or a space),\n  # see if adding a number works\n  if exp.match /[^\\d\\)\\s]+$/\n    newExp += '1'\n    ++numbersAdded\n\n  # if it ends with a number following a space,\n  # see if adding a denominator works\n  else if exp.match /\\s\\d+$/\n    newExp += '/1'\n    ++symbolsAdded\n    ++numbersAdded\n\n  # if it ends with a space, see if adding a fraction works\n  else if exp.match /\\s$/\n    newExp += '1/1'\n    ++symbolsAdded\n    numbersAdded += 2\n\n  # balance close parenthesis\n  openParens = (exp.match(/\\(/g) or []).length\n  closeParens = (exp.match(/\\)/g) or []).length\n  parensAdded = openParens - closeParens\n  newExp += ')' while openParens-- > closeParens\n\n  if exp isnt newExp\n    try\n      ast = parser.parse newExp\n      if parensAdded > 0 or symbolsAdded > 0 or numbersAdded > 0\n        ast.incomplete = {}\n        ast.incomplete.parens  = parensAdded  if parensAdded  > 0 # )s added\n        ast.incomplete.symbols = symbolsAdded if symbolsAdded > 0 # /s added\n        ast.incomplete.numbers = numbersAdded if numbersAdded > 0 # 1s added\n        replaceNumberWithMissing ast while numbersAdded-- > 0\n      return ast\n\n  # couldn't \"fix\" the expression\n  { error: error.message }\n\ninterpret = (ast, interpreter) ->\n  return null if !ast\n  return interpreter.error ast.error if ast.error?\n  map = (o, f) -> if o.map? then o.map f else f o\n  recur = (o) ->\n    if o.type is 'num' or o.type is 'missing' # leaf nodes, don't recur\n      interpreter[o.type] o.arg\n    else\n      interpreter[o.type] (map o.arg, recur)\n  interpreter.post recur ast\n\n# calculate AST result\ncalc = (ast) ->\n  if ast.incomplete?.numbers\n    { error: 'incomplete expression' }\n  else\n    try\n      f = fraction\n      interpret ast,\n        error: -> ''\n        num: (n) -> f.create n\n        add: (a) -> a.reduce (p, e) -> f.add p, e\n        minus: (e) -> f.minus e\n        mul: (a) -> a.reduce (p, e) -> f.mul p, e\n        div: (e) -> f.reciprocal e\n        mixed: (a) ->\n          [w, n, d] = a.map (e) -> e.n\n          f.mixed w, n, d\n        over: (a) ->\n          [n, d] = a.map (e) -> e.n\n          f.create n, d\n        exp: (e) -> e\n        post: (r) -> r\n    catch e\n      { error : e.message }\n\n# render AST as TeX\nrender = (ast, options) ->\n\n  withResult = (s) ->\n    result = calc(ast)\n    return error: result.error if result.error?\n    r = render parse result.toString()\n    m = render parse result.toMixedString()\n    ret = s\n    ret += \" = #{r}\" if s isnt r\n    ret += \" = #{m}\" if m isnt r and m isnt s\n    ret\n\n  interpret ast,\n    error: (e) -> error: e\n    missing: -> ''\n    num: (n) -> \"#{n}\"\n    add: (a) -> a.reduce (p, e) -> \"#{p} + #{e}\"\n    minus: (e) -> \"-#{e}\"\n    mul: (a) -> a.reduce (p, e) -> \"#{p} \\\\times #{e}\"\n    div: (e) -> \"\\\\div #{e}\"\n    mixed: (a) ->\n      [w, n, d] = a\n      \"#{w} \\\\frac{#{n or '\\\\circ'}}{#{d or '\\\\circ'}}\"\n    over: (a) ->\n      [n, d] = a\n      if d? then \"\\\\frac{#{n}}{#{d or '\\\\circ'}}\" else n\n    exp: (e) -> \"\\\\left( #{e} \\\\right)\"\n    post: (s) ->\n      s = s\n        .replace /\\\\times \\\\div/g, '\\\\div'\n        .replace /\\+(\\s)?-/g, '-$1'\n        .replace /-(\\s)?-/g, '+$1'\n        .replace /\\s{2,}/g, ' '\n      if options?.result\n        withResult s\n      else\n        s\n\nclass Parsed\n  constructor: (@ast) ->\n  calc: -> calc @ast\n  render: (options) -> render @ast, options\n\nmodule.exports =\n  parse: (e) -> new Parsed parse e\n","module.exports = (function() {\n  \"use strict\";\n\n  /*\n   * Generated by PEG.js 0.9.0.\n   *\n   * http://pegjs.org/\n   */\n\n  function peg$subclass(child, parent) {\n    function ctor() { this.constructor = child; }\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n  }\n\n  function peg$SyntaxError(message, expected, found, location) {\n    this.message  = message;\n    this.expected = expected;\n    this.found    = found;\n    this.location = location;\n    this.name     = \"SyntaxError\";\n\n    if (typeof Error.captureStackTrace === \"function\") {\n      Error.captureStackTrace(this, peg$SyntaxError);\n    }\n  }\n\n  peg$subclass(peg$SyntaxError, Error);\n\n  function peg$parse(input) {\n    var options = arguments.length > 1 ? arguments[1] : {},\n        parser  = this,\n\n        peg$FAILED = {},\n\n        peg$startRuleFunctions = { S: peg$parseS },\n        peg$startRuleFunction  = peg$parseS,\n\n        peg$c0 = { type: \"other\", description: \"expression\" },\n        peg$c1 = \"+\",\n        peg$c2 = { type: \"literal\", value: \"+\", description: \"\\\"+\\\"\" },\n        peg$c3 = \"-\",\n        peg$c4 = { type: \"literal\", value: \"-\", description: \"\\\"-\\\"\" },\n        peg$c5 = function(left, right) { return add([left].concat(terms(right))); },\n        peg$c6 = { type: \"other\", description: \"term\" },\n        peg$c7 = \"*\",\n        peg$c8 = { type: \"literal\", value: \"*\", description: \"\\\"*\\\"\" },\n        peg$c9 = \"\\xF7\",\n        peg$c10 = { type: \"literal\", value: \"\\xF7\", description: \"\\\"\\\\xF7\\\"\" },\n        peg$c11 = function(left, right) { return mul([left].concat(factors(right))); },\n        peg$c12 = { type: \"other\", description: \"fraction\" },\n        peg$c13 = \"/\",\n        peg$c14 = { type: \"literal\", value: \"/\", description: \"\\\"/\\\"\" },\n        peg$c15 = function(left, right) { return over([left, right]); },\n        peg$c16 = \" \",\n        peg$c17 = { type: \"literal\", value: \" \", description: \"\\\" \\\"\" },\n        peg$c18 = function(whole, left, right) { return mixed([whole, left, right]); },\n        peg$c19 = { type: \"other\", description: \"factor\" },\n        peg$c20 = \"(\",\n        peg$c21 = { type: \"literal\", value: \"(\", description: \"\\\"(\\\"\" },\n        peg$c22 = \")\",\n        peg$c23 = { type: \"literal\", value: \")\", description: \"\\\")\\\"\" },\n        peg$c24 = function(sign, expression) {\r\n            var r = exp(expression);\r\n            return sign==='-'?minus(r):r;\r\n          },\n        peg$c25 = { type: \"other\", description: \"integer\" },\n        peg$c26 = function(sign, uint) { return num(parseInt((sign||\"\")+uint.arg, 10)); },\n        peg$c27 = { type: \"other\", description: \"unsigned integer\" },\n        peg$c28 = /^[0-9]/,\n        peg$c29 = { type: \"class\", value: \"[0-9]\", description: \"[0-9]\" },\n        peg$c30 = function(digits) { return num(parseInt(digits.join(\"\"), 10)); },\n\n        peg$currPos          = 0,\n        peg$savedPos         = 0,\n        peg$posDetailsCache  = [{ line: 1, column: 1, seenCR: false }],\n        peg$maxFailPos       = 0,\n        peg$maxFailExpected  = [],\n        peg$silentFails      = 0,\n\n        peg$result;\n\n    if (\"startRule\" in options) {\n      if (!(options.startRule in peg$startRuleFunctions)) {\n        throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n      }\n\n      peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n    }\n\n    function text() {\n      return input.substring(peg$savedPos, peg$currPos);\n    }\n\n    function location() {\n      return peg$computeLocation(peg$savedPos, peg$currPos);\n    }\n\n    function expected(description) {\n      throw peg$buildException(\n        null,\n        [{ type: \"other\", description: description }],\n        input.substring(peg$savedPos, peg$currPos),\n        peg$computeLocation(peg$savedPos, peg$currPos)\n      );\n    }\n\n    function error(message) {\n      throw peg$buildException(\n        message,\n        null,\n        input.substring(peg$savedPos, peg$currPos),\n        peg$computeLocation(peg$savedPos, peg$currPos)\n      );\n    }\n\n    function peg$computePosDetails(pos) {\n      var details = peg$posDetailsCache[pos],\n          p, ch;\n\n      if (details) {\n        return details;\n      } else {\n        p = pos - 1;\n        while (!peg$posDetailsCache[p]) {\n          p--;\n        }\n\n        details = peg$posDetailsCache[p];\n        details = {\n          line:   details.line,\n          column: details.column,\n          seenCR: details.seenCR\n        };\n\n        while (p < pos) {\n          ch = input.charAt(p);\n          if (ch === \"\\n\") {\n            if (!details.seenCR) { details.line++; }\n            details.column = 1;\n            details.seenCR = false;\n          } else if (ch === \"\\r\" || ch === \"\\u2028\" || ch === \"\\u2029\") {\n            details.line++;\n            details.column = 1;\n            details.seenCR = true;\n          } else {\n            details.column++;\n            details.seenCR = false;\n          }\n\n          p++;\n        }\n\n        peg$posDetailsCache[pos] = details;\n        return details;\n      }\n    }\n\n    function peg$computeLocation(startPos, endPos) {\n      var startPosDetails = peg$computePosDetails(startPos),\n          endPosDetails   = peg$computePosDetails(endPos);\n\n      return {\n        start: {\n          offset: startPos,\n          line:   startPosDetails.line,\n          column: startPosDetails.column\n        },\n        end: {\n          offset: endPos,\n          line:   endPosDetails.line,\n          column: endPosDetails.column\n        }\n      };\n    }\n\n    function peg$fail(expected) {\n      if (peg$currPos < peg$maxFailPos) { return; }\n\n      if (peg$currPos > peg$maxFailPos) {\n        peg$maxFailPos = peg$currPos;\n        peg$maxFailExpected = [];\n      }\n\n      peg$maxFailExpected.push(expected);\n    }\n\n    function peg$buildException(message, expected, found, location) {\n      function cleanupExpected(expected) {\n        var i = 1;\n\n        expected.sort(function(a, b) {\n          if (a.description < b.description) {\n            return -1;\n          } else if (a.description > b.description) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n\n        while (i < expected.length) {\n          if (expected[i - 1] === expected[i]) {\n            expected.splice(i, 1);\n          } else {\n            i++;\n          }\n        }\n      }\n\n      function buildMessage(expected, found) {\n        function stringEscape(s) {\n          function hex(ch) { return ch.charCodeAt(0).toString(16).toUpperCase(); }\n\n          return s\n            .replace(/\\\\/g,   '\\\\\\\\')\n            .replace(/\"/g,    '\\\\\"')\n            .replace(/\\x08/g, '\\\\b')\n            .replace(/\\t/g,   '\\\\t')\n            .replace(/\\n/g,   '\\\\n')\n            .replace(/\\f/g,   '\\\\f')\n            .replace(/\\r/g,   '\\\\r')\n            .replace(/[\\x00-\\x07\\x0B\\x0E\\x0F]/g, function(ch) { return '\\\\x0' + hex(ch); })\n            .replace(/[\\x10-\\x1F\\x80-\\xFF]/g,    function(ch) { return '\\\\x'  + hex(ch); })\n            .replace(/[\\u0100-\\u0FFF]/g,         function(ch) { return '\\\\u0' + hex(ch); })\n            .replace(/[\\u1000-\\uFFFF]/g,         function(ch) { return '\\\\u'  + hex(ch); });\n        }\n\n        var expectedDescs = new Array(expected.length),\n            expectedDesc, foundDesc, i;\n\n        for (i = 0; i < expected.length; i++) {\n          expectedDescs[i] = expected[i].description;\n        }\n\n        expectedDesc = expected.length > 1\n          ? expectedDescs.slice(0, -1).join(\", \")\n              + \" or \"\n              + expectedDescs[expected.length - 1]\n          : expectedDescs[0];\n\n        foundDesc = found ? \"\\\"\" + stringEscape(found) + \"\\\"\" : \"end of input\";\n\n        return \"Expected \" + expectedDesc + \" but \" + foundDesc + \" found.\";\n      }\n\n      if (expected !== null) {\n        cleanupExpected(expected);\n      }\n\n      return new peg$SyntaxError(\n        message !== null ? message : buildMessage(expected, found),\n        expected,\n        found,\n        location\n      );\n    }\n\n    function peg$parseS() {\n      var s0;\n\n      s0 = peg$parseE();\n\n      return s0;\n    }\n\n    function peg$parseE() {\n      var s0, s1, s2, s3, s4, s5;\n\n      peg$silentFails++;\n      s0 = peg$currPos;\n      s1 = peg$parseT();\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        s3 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 43) {\n          s4 = peg$c1;\n          peg$currPos++;\n        } else {\n          s4 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c2); }\n        }\n        if (s4 === peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 45) {\n            s4 = peg$c3;\n            peg$currPos++;\n          } else {\n            s4 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c4); }\n          }\n        }\n        if (s4 !== peg$FAILED) {\n          s5 = peg$parseT();\n          if (s5 !== peg$FAILED) {\n            s4 = [s4, s5];\n            s3 = s4;\n          } else {\n            peg$currPos = s3;\n            s3 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n        if (s3 !== peg$FAILED) {\n          while (s3 !== peg$FAILED) {\n            s2.push(s3);\n            s3 = peg$currPos;\n            if (input.charCodeAt(peg$currPos) === 43) {\n              s4 = peg$c1;\n              peg$currPos++;\n            } else {\n              s4 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c2); }\n            }\n            if (s4 === peg$FAILED) {\n              if (input.charCodeAt(peg$currPos) === 45) {\n                s4 = peg$c3;\n                peg$currPos++;\n              } else {\n                s4 = peg$FAILED;\n                if (peg$silentFails === 0) { peg$fail(peg$c4); }\n              }\n            }\n            if (s4 !== peg$FAILED) {\n              s5 = peg$parseT();\n              if (s5 !== peg$FAILED) {\n                s4 = [s4, s5];\n                s3 = s4;\n              } else {\n                peg$currPos = s3;\n                s3 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s3;\n              s3 = peg$FAILED;\n            }\n          }\n        } else {\n          s2 = peg$FAILED;\n        }\n        if (s2 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c5(s1, s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$parseT();\n      }\n      peg$silentFails--;\n      if (s0 === peg$FAILED) {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c0); }\n      }\n\n      return s0;\n    }\n\n    function peg$parseT() {\n      var s0, s1, s2, s3, s4, s5;\n\n      peg$silentFails++;\n      s0 = peg$currPos;\n      s1 = peg$parseF();\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        s3 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 42) {\n          s4 = peg$c7;\n          peg$currPos++;\n        } else {\n          s4 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c8); }\n        }\n        if (s4 === peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 247) {\n            s4 = peg$c9;\n            peg$currPos++;\n          } else {\n            s4 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c10); }\n          }\n        }\n        if (s4 !== peg$FAILED) {\n          s5 = peg$parseF();\n          if (s5 !== peg$FAILED) {\n            s4 = [s4, s5];\n            s3 = s4;\n          } else {\n            peg$currPos = s3;\n            s3 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n        if (s3 !== peg$FAILED) {\n          while (s3 !== peg$FAILED) {\n            s2.push(s3);\n            s3 = peg$currPos;\n            if (input.charCodeAt(peg$currPos) === 42) {\n              s4 = peg$c7;\n              peg$currPos++;\n            } else {\n              s4 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c8); }\n            }\n            if (s4 === peg$FAILED) {\n              if (input.charCodeAt(peg$currPos) === 247) {\n                s4 = peg$c9;\n                peg$currPos++;\n              } else {\n                s4 = peg$FAILED;\n                if (peg$silentFails === 0) { peg$fail(peg$c10); }\n              }\n            }\n            if (s4 !== peg$FAILED) {\n              s5 = peg$parseF();\n              if (s5 !== peg$FAILED) {\n                s4 = [s4, s5];\n                s3 = s4;\n              } else {\n                peg$currPos = s3;\n                s3 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s3;\n              s3 = peg$FAILED;\n            }\n          }\n        } else {\n          s2 = peg$FAILED;\n        }\n        if (s2 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c11(s1, s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$parseF();\n      }\n      peg$silentFails--;\n      if (s0 === peg$FAILED) {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c6); }\n      }\n\n      return s0;\n    }\n\n    function peg$parseF() {\n      var s0, s1, s2, s3, s4, s5;\n\n      peg$silentFails++;\n      s0 = peg$currPos;\n      s1 = peg$parseI();\n      if (s1 !== peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 47) {\n          s2 = peg$c13;\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c14); }\n        }\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parseI();\n          if (s3 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c15(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parseI();\n        if (s1 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 32) {\n            s2 = peg$c16;\n            peg$currPos++;\n          } else {\n            s2 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c17); }\n          }\n          if (s2 !== peg$FAILED) {\n            s3 = peg$parseU();\n            if (s3 !== peg$FAILED) {\n              if (input.charCodeAt(peg$currPos) === 47) {\n                s4 = peg$c13;\n                peg$currPos++;\n              } else {\n                s4 = peg$FAILED;\n                if (peg$silentFails === 0) { peg$fail(peg$c14); }\n              }\n              if (s4 !== peg$FAILED) {\n                s5 = peg$parseI();\n                if (s5 !== peg$FAILED) {\n                  peg$savedPos = s0;\n                  s1 = peg$c18(s1, s3, s5);\n                  s0 = s1;\n                } else {\n                  peg$currPos = s0;\n                  s0 = peg$FAILED;\n                }\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n        if (s0 === peg$FAILED) {\n          s0 = peg$parseR();\n        }\n      }\n      peg$silentFails--;\n      if (s0 === peg$FAILED) {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c12); }\n      }\n\n      return s0;\n    }\n\n    function peg$parseR() {\n      var s0, s1, s2, s3, s4;\n\n      peg$silentFails++;\n      s0 = peg$parseI();\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 45) {\n          s1 = peg$c3;\n          peg$currPos++;\n        } else {\n          s1 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c4); }\n        }\n        if (s1 === peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 43) {\n            s1 = peg$c1;\n            peg$currPos++;\n          } else {\n            s1 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c2); }\n          }\n        }\n        if (s1 === peg$FAILED) {\n          s1 = null;\n        }\n        if (s1 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 40) {\n            s2 = peg$c20;\n            peg$currPos++;\n          } else {\n            s2 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c21); }\n          }\n          if (s2 !== peg$FAILED) {\n            s3 = peg$parseE();\n            if (s3 !== peg$FAILED) {\n              if (input.charCodeAt(peg$currPos) === 41) {\n                s4 = peg$c22;\n                peg$currPos++;\n              } else {\n                s4 = peg$FAILED;\n                if (peg$silentFails === 0) { peg$fail(peg$c23); }\n              }\n              if (s4 !== peg$FAILED) {\n                peg$savedPos = s0;\n                s1 = peg$c24(s1, s3);\n                s0 = s1;\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      }\n      peg$silentFails--;\n      if (s0 === peg$FAILED) {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c19); }\n      }\n\n      return s0;\n    }\n\n    function peg$parseI() {\n      var s0, s1, s2;\n\n      peg$silentFails++;\n      s0 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 45) {\n        s1 = peg$c3;\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c4); }\n      }\n      if (s1 === peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 43) {\n          s1 = peg$c1;\n          peg$currPos++;\n        } else {\n          s1 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c2); }\n        }\n      }\n      if (s1 === peg$FAILED) {\n        s1 = null;\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parseU();\n        if (s2 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c26(s1, s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      peg$silentFails--;\n      if (s0 === peg$FAILED) {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c25); }\n      }\n\n      return s0;\n    }\n\n    function peg$parseU() {\n      var s0, s1, s2;\n\n      peg$silentFails++;\n      s0 = peg$currPos;\n      s1 = [];\n      if (peg$c28.test(input.charAt(peg$currPos))) {\n        s2 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c29); }\n      }\n      if (s2 !== peg$FAILED) {\n        while (s2 !== peg$FAILED) {\n          s1.push(s2);\n          if (peg$c28.test(input.charAt(peg$currPos))) {\n            s2 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s2 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c29); }\n          }\n        }\n      } else {\n        s1 = peg$FAILED;\n      }\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c30(s1);\n      }\n      s0 = s1;\n      peg$silentFails--;\n      if (s0 === peg$FAILED) {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c27); }\n      }\n\n      return s0;\n    }\n\n\r\n      function num(n){return {type:'num',arg:n};}\r\n      function add(a){return {type:'add',arg:a};}\r\n      function mul(a){return {type:'mul',arg:a};}\r\n      function over(a){return {type:'over',arg:a};}\r\n      function mixed(a){return {type:'mixed',arg:a};}\r\n      function exp(e){return {type:'exp',arg:e};}\r\n      function minus(e){return {type:\"minus\",arg:e};}\r\n      function div(e){return {type:\"div\",arg:e};}\r\n\r\n      function terms(a) {\n        return a.map(function(e) {\n          if (e[0] === \"-\") {\n            if (e[1].type === 'num') {\n              e[1].arg = -e[1].arg;\n            }\n            else {\n              return minus(e[1]);\n            }\n          }\n          return e[1];\n        });\n      }\r\n\r\n      function factors(a) {\r\n        return a.map(function(e) {\r\n          if (e[0] === \"\") {\r\n            return div(e[1]);\r\n          }\r\n          return e[1];\r\n        });\r\n      }\r\n\n\n    peg$result = peg$startRuleFunction();\n\n    if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n      return peg$result;\n    } else {\n      if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n        peg$fail({ type: \"end\", description: \"end of input\" });\n      }\n\n      throw peg$buildException(\n        null,\n        peg$maxFailExpected,\n        peg$maxFailPos < input.length ? input.charAt(peg$maxFailPos) : null,\n        peg$maxFailPos < input.length\n          ? peg$computeLocation(peg$maxFailPos, peg$maxFailPos + 1)\n          : peg$computeLocation(peg$maxFailPos, peg$maxFailPos)\n      );\n    }\n  }\n\n  return {\n    SyntaxError: peg$SyntaxError,\n    parse:       peg$parse\n  };\n})();","### global module ###\n\ngcd = (n, d) ->\r\n  r = 0\r\n  until d is 0\r\n    r = n % d\r\n    n = d\r\n    d = r\r\n  Math.abs n\r\n\ndiv0 = new Error 'Division by zero!'\n\nclass Fraction\n\n  constructor: (n, d = 1) ->\n    throw div0 if d is 0\n    [n, d] = [-n, -d] if d < 0\n    div = gcd n, d\n    @n = n / div\n    @d = d / div\n\n  isProper: -> @n < @d\n\n  toFloat: -> @n / @d\n\n  toString: -> if @d is 1 then \"#{@n}\" else \"#{@n}/#{@d}\"\n\n  toMixedString: ->\n    if @isProper()\n      @toString()\n    else if @n % @d is 0\n      \"#{@n // @d}\"\n    else\n      \"#{@n // @d} #{@n % @d}/#{@d}\"\n\n  @create: (n, d) -> new Fraction n, d\n\n  @mixed: (w, n, d) -> @create n + w*d, d\n\n  @add: (l, r) ->\n    [a, b, c, d] = [l.n, l.d, r.n, r.d]\n    @create a*d + c*b, b*d\n\n  @minus = (f) ->\n    [n, d] = [f.n, f.d]\n    @create -n, d\n\n  @mul = (l, r) ->\n    [a, b, c, d] = [l.n, l.d, r.n, r.d]\n    @create a*c, b*d\n\n  @div = (l, r) ->\n    [a, b, c, d] = [l.n, l.d, r.n, r.d]\n    @create a*d, b*c\n\n  @reciprocal = (f) ->\n    [n, d] = [f.n, f.d]\n    @create d, n\n\nmodule.exports = Fraction\r\n","### global MathJax,jQuery,require ###\n\n$ = jQuery\n\n$ ->\n  $calculator = $ '#calculator'\n  $output = $ '#output'\n  $decimal = $ '#decimal'\n  $buffer = $ '#buffer' # buffer for MathJax\n  $parsed = $ '#parsed' # for debugging\n\n  adjustCss = ->\n    # adjust mathjax generated styles\n    $ '.MathJax_Display'\n      .css 'margin', '0'\n      .css 'text-align', 'right'\n\n  adjustParens = (n) ->\n    return if n is 0\n    # gray out added closing parenthesis\n    parens = $ '#output .MathJax_Display span'\n      .filter (i, s) -> $(s).text() is ')'\n    $ parens[-n..-1]\n      .addClass 'dimmed'\n\n  getPlaceholders = () ->\n    $ '#output .MathJax_Display span'\n      .filter (i, s) -> $(s).text() is '' # in TeX this is \\circ\n\n  adjustPlaceholders = () -> getPlaceholders().addClass 'dimmed'\n\n  adjustFraction = () ->\n    getPlaceholders()\n      .last()\n      .parent()\n      .parent()\n      .addClass 'dimmed'\n      .children 'span'\n      .filter (i, s) -> $(s).text().match /\\d+/\n      .css 'color', '#333' # this is normal MathJax's color\n\n  output = (tex, info) ->\n    $decimal.text if info?.decimal? then info.decimal else ''\n    MathJax.Hub.Queue ->\n      $parsed.text tex\n      $buffer.text \"$$#{tex}$$\"\n      MathJax.Hub.Typeset $buffer.get(), ->\n        $output.html $buffer.html() if $parsed.text() is tex\n        adjustCss()\n        adjustParens info?.incomplete?.parens or 0\n        if info?.incomplete?.symbols > 0\n          adjustFraction()\n        else\n          adjustPlaceholders()\n        # scroll left all the way\n        $('#output').scrollLeft 1000000000\n\n  calculator = (require './calculator')\n    output: output\n    onError: (s) -> alert s\n\n  getKey = ($b) -> $b.data('symbol') or $b.text()\n\n  $buttons = $ '.btn'\n  charCodes = $buttons.map -> (getKey $(this)).charCodeAt 0\n\n  $calculator\n    .keypress (e) ->\n      key =\n        if e.which is 13 # <ENTER>\n          '='\n        else\n          (String.fromCharCode e.which).toUpperCase()\n      keyCode = key.charCodeAt 0\n      if (charCodes.index keyCode) isnt -1\n        calculator.input key\n        toggleButtons()\n    .keydown (e) ->\n      if e.which is 8 # <BACKSPACE>\n        calculator.uninput()\n        toggleButtons()\n        e.preventDefault() # don't allow back navigation with <BACKSPACE>\n\n  $buttons.click ->\n    calculator.input getKey $(this)\n    toggleButtons()\n\n  toggleButtons = ->\n    $buttons.each ->\n      if calculator.canInput getKey $(this)\n        this.removeAttribute 'disabled'\n      else\n        this.setAttribute 'disabled', 'disabled'\n\n  toggleButtons()\n  $calculator.focus()\n"]}